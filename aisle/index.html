<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta property="og:image" itemprop="image" content="/images/bride.png">
  <meta property="og:description" content="Tomy & Alexa Virtual Wedding Reception">

  <title>Tomy & Lexa | Virtual Wedding Reception</title>
  <link rel="icon" href="images/favicon-16.png">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tour/0.12.0/css/bootstrap-tour-standalone.min.css">

  <!-- CSS Stylesheet  -->
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="css/style.css">

</head>

<body>
  <div class="container-fluid wrap-aisle">
    <!-- Header -->
    <div class="header header-gallery">

      <div id="checkbox-container2" class="header-div">
        <input type="checkbox" class="checkbox" id="toggleLang" />
        <label class="label" for="toggleLang">
          <img class="flag-circle uk" src="../images/lang/uk-circle.png" alt="">
          <img class="flag-circle ind" src="../images/lang/ind-circle.png" alt="">
          <div class="ball"></div>
        </label>

        <img class="exit header-icon" src="../images/exit.svg" alt="">
      </div>
    </div>

    <div class="streaming-vcall">
      <iframe src="https://www.youtube.com/embed/rfiBgrs47iI?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"></iframe>
      <!-- <iframe src="https://www.youtube.com/embed/E97RjpnrO7U?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"></iframe> -->
      <div class="wrap-running-text wrap-rt-1">
        <div class="static-text">
          <h5 class="lang" key="in-pelaminan">Sedang di pelaminan:</h5>
          <div class="marquee">
            <div class="inner">
              <p>
                <span id="tamu1"></span>
                <span id="tamu2"></span>
                <span id="tamu3"></span>
                <span id="tamu4"></span>
                <span id="tamu5"></span>
                <span id="tamu6"></span>
                <span id="tamu7"></span>
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="wrap-running-text wrap-rt-2">
        <div class="static-text">
          <h5 class="lang" key="next-pelaminan">Selanjutnya:</h5>
          <div class="marquee">
            <div class="inner">
              <p>
                <span id="next1"></span>
                <span id="next2"></span>
                <span id="next3"></span>
                <span id="next4"></span>
                <span id="next5"></span>
                <span id="next6"></span>
                <span id="next7"></span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="live-mc" class="live-mc"></div>

    <div class="video-mc embed-responsive">
      <iframe class="" src="https://www.youtube.com/embed/6ksnNqA302I?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
  </div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tour/0.12.0/js/bootstrap-tour-standalone.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" charset="utf-8"></script>
  <script src="../index.js" charset="utf-8"></script>

  <script type="text/javascript">
    var dirPath = dirname(location.href);
    var homePath = RemoveLastDirectoryPartOf(dirPath);

    function dirname(path) {
      return path.replace(/\\/g, '/').replace(/\/[^\/]*$/, '');
    }

    function RemoveLastDirectoryPartOf(the_url) {
      var the_arr = the_url.split('/');
      the_arr.pop();
      return (the_arr.join('/'));
    }

    // TOKEN DATA
    var name = null;
    var timeSet = null;


    cookieToken = $.cookie("token");
    console.log("token " + cookieToken);

    if (cookieToken == null) {
      var fullPath = dirPath + "/login";
      console.log(fullPath);
      window.location = fullPath;
    }

    // Time group
    var timeCheck = new Date();
    var minuteEdit = parseInt(timeCheck.getMinutes()) - (parseInt(timeCheck.getMinutes()) % 5);
    var minuteEdit2 = minuteEdit + 5;

    var groupVcall = [];
    var groupVcall2 = [];

    console.log("array");
    console.log(groupVcall.length);

    timeGroup = timeCheck.getHours() + ":" + minuteEdit.toString();
    timeGroup2 = timeCheck.getHours() + ":" + minuteEdit2.toString();

    $.ajax({
      url: "https://webnikahapi.arthatronic.com/api/user/" + timeGroup,
      async: false,
      type: "GET",
      global: false,
      success: function(result) {
        console.log("get time group");
        console.log(result);
        for (var i = 0; i < result.length; i++) {
          var item = result[i].name;
          groupVcall.push(item);
        }
        console.log(groupVcall);
      },
      error: function(err) {
        console.log(err);
      }
    });

    // Show list tamu yg lagi concall
    if (groupVcall.length > 0) {
      $("#tamu1").html(groupVcall[0] + "<span> | </span>");
      $("#tamu2").html(groupVcall[1] + "<span> | </span>");
      $("#tamu3").html(groupVcall[2] + "<span> | </span>");
      $("#tamu4").html(groupVcall[3] + "<span> | </span>");
      $("#tamu5").html(groupVcall[4] + "<span> | </span>");
      $("#tamu6").html(groupVcall[5] + "<span> | </span>");
      $("#tamu7").html(groupVcall[6] + "<span> | </span>");
    }

    $.ajax({
      url: "https://webnikahapi.arthatronic.com/api/user/" + timeGroup2,
      async: false,
      type: "GET",
      global: false,
      success: function(result) {
        console.log("get time group");
        console.log(result);
        for (var i = 0; i < result.length; i++) {
          var item2 = result[i].name;
          groupVcall2.push(item2);
        }
        console.log(groupVcall2);
      },
      error: function(err) {
        console.log(err);
      }
    });

    // Show list tamu next concall
    if (groupVcall2.length > 0) {
      $("#next1").html(groupVcall2[0] + "<span> | </span>");
      $("#next2").html(groupVcall2[1] + "<span> | </span>");
      $("#next3").html(groupVcall2[2] + "<span> | </span>");
      $("#next4").html(groupVcall2[3] + "<span> | </span>");
      $("#next5").html(groupVcall2[4] + "<span> | </span>");
      $("#next6").html(groupVcall2[5] + "<span> | </span>");
      $("#next7").html(groupVcall2[6] + "<span> | </span>");
    }

    // Token data
    $.ajax({
      url: "https://webnikahapi.arthatronic.com/api/user/",
      async: false,
      type: "GET",
      global: false,
      // Fetch the stored token from localStorage and set in the header
      headers: {
        "Authorization": "Token " + cookieToken
      },
      success: function(result) {
        console.log("get data user");
        console.log(result);
        name = result[0].name;
        timeSet = result[0].time;
        console.log(name);
        console.log(timeSet);
      },
      error: function(err) {
        console.log(err);
      }
    });

    console.log("nama homepage " + name);
    $("#welcomeName").html(name);

    var endTime = new Date("13 August 2020 " + timeSet + " GMT+07:00");

    console.log("endtimeeeee" + endTime);
    // endTime = (Date.parse(endTime) / 1000) + 10;

    endTime = (Date.parse(endTime) / 1000);

    var welcomeState = localStorage.getItem("welcomeState");

    function makeTimer() {

      // var endTime = new Date("5 August 2020 " + timeSet + " GMT+07:00");

      // manual
      now = new Date();
      timeNow = now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds();

      // var endTime = new Date("6 August 2020 17:38:05 GMT+07:00");

      timeNow = (Date.parse(now) / 1000);

      var timeLeft = endTime - timeNow;
      console.log("timeleft " + timeLeft);
      var days = Math.floor(timeLeft / 86400);
      var hours = Math.floor((timeLeft - (days * 86400)) / 3600);
      var minutes = Math.floor((timeLeft - (days * 86400) - (hours * 3600)) / 60);
      var seconds = Math.floor((timeLeft - (days * 86400) - (hours * 3600) - (minutes * 60)));

      if (hours < "10") {
        hours = "0" + hours;
      }
      if (minutes < "10") {
        minutes = "0" + minutes;
      }
      if (seconds < "10") {
        seconds = "0" + seconds;
      }

      $("#hours").html(hours + "<span> :</span>");
      $("#minutes").html(minutes + "<span> :</span>");
      $("#seconds").html(seconds);

      console.log(hours + ":" + minutes + ":" + seconds);

      // Popup Vcall
      if (parseInt(hours) <= 0 && parseInt(minutes) <= 0 && parseInt(seconds) <= 0) {
        $("#welcomeModal").css('display', 'none');
        $("#earlyBird").css('display', 'none');
        $("#vcallModal").css('display', 'block');

        console.log("nol");

        var counterVcall = 5;
        var interval = setInterval(function() {
          // Display 'counter' wherever you want to display it.
          $("#redirectVcall2").html(counterVcall);
          counterVcall--;
          console.log("masuk counter");
          console.log(counterVcall);
          if (counterVcall == 0) {
            // Display a login box
            clearInterval(interval);
            $("#vcallModal").css('display', 'block');
            console.log(dirPath);
            var fullPath = homePath + "/Vcall";
            console.log(fullPath);
            window.location = fullPath;
            // return false;
          }
        }, 1000);
      }

      // Jam Karet
      // if (hours < "3") {
      //   // Select language @ modal
      //   $("#checkbox-ind").click(function() {
      //     $("#toggleLang").prop('checked', false);
      //
      //     // close modal, pop user modal
      //     $("#welcomeModal").delay(1000).queue(function(next) {
      //       $("#welcomeModal").css("display", "none");
      //       $("#earlyBird").css("display", "block");
      //     });
      //   });
      //
      //   $("#checkbox-eng").click(function() {
      //     $("#toggleLang").prop('checked', true);
      //
      //     $("#welcomeModal").delay(1000).queue(function(next) {
      //       $("#welcomeModal").css("display", "none");
      //       $("#earlyBird").css("display", "block");
      //     });
      //   });
      // }

      // if (hours > "20") {
      //   $("#checkbox-ind").click(function() {
      //     $("#welcomeModal").delay(1000).queue(function(next) {
      //       $("#earlyBird").css('display', 'none');
      //       $("#karetModal").css('display', 'block');
      //     });
      //   });
      //   $("#checkbox-eng").click(function() {
      //     $("#welcomeModal").delay(1000).queue(function(next) {
      //       $("#earlyBird").css('display', 'none');
      //       $("#karetModal").css('display', 'block');
      //     });
      //   });
      // }
    }

    setInterval(function() {
      makeTimer();
    }, 1000);

    $("#btn-next-2").click(function() {
      $("#welcomeModal").css('display', 'none');
      $("#earlyBird").css('display', 'none');
    });

    // Running text
    function handleMarquee() {
      const marquee = document.querySelectorAll('.marquee');
      let speed = 1;
      let lastScrollPos = 0;
      let timer;
      marquee.forEach(function(el) {
        const container = el.querySelector('.inner');
        const content = el.querySelector('.inner > *');
        //Get total width
        const elWidth = content.offsetWidth;
        //Duplicate content
        let clone = content.cloneNode(true);
        container.appendChild(clone);
        let progress = 1;

        function loop() {
          progress = progress - speed;
          if (progress <= elWidth * -1) {
            progress = 0;
          }
          container.style.transform = 'translateX(' + progress + 'px)';
          container.style.transform += 'skewX(' + speed * 0.4 + 'deg)';
          window.requestAnimationFrame(loop);
        }
        loop();
      });
      window.addEventListener('scroll', function() {
        const maxScrollValue = 12;
        const newScrollPos = window.scrollY;
        let scrollValue = newScrollPos - lastScrollPos;
        if (scrollValue > maxScrollValue) scrollValue = maxScrollValue;
        else if (scrollValue < -maxScrollValue) scrollValue = -maxScrollValue;
        speed = scrollValue;
        clearTimeout(timer);
        timer = setTimeout(handleSpeedClear, 10);
      });

      function handleSpeedClear() {
        speed = 1;
      }
    };
    handleMarquee();
  </script>
</body>

</html>
